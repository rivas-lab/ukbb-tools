#!/bin/bash
set -beEuo pipefail

SRCNAME=$(readlink -f $0)
SRCDIR=$(dirname ${SRCNAME})
PROGNAME=$(basename $SRCNAME)
VERSION="0.0.1"
NUM_POS_ARGS="1"

source "${SRCDIR}/18_metal_misc.sh"

############################################################
# functions
############################################################

usage () {
cat <<- EOF
	$PROGNAME (version $VERSION)
	Extract the list of input files used in the Metal analysis from the specified metal.info.txt.
	
	Usage: $PROGNAME [options] metal.info.txt
	  metal.info.txt     The metal.info.txt file generated from run_metal.sh
EOF
}

############################################################
# parser start
############################################################

declare -a params=()
for OPT in "$@" ; do
    case "$OPT" in 
        '-h' | '--help' )
            usage >&2 ; exit 0 ; 
            ;;
        '-v' | '--version' )
            echo $VERSION ; exit 0 ;
            ;;
        '--'|'-' )
            shift 1 ; params+=( "$@" ) ; break
            ;;
        -*)
            echo "$PROGNAME: illegal option -- '$(echo $1 | sed 's/^-*//')'" 1>&2 ; exit 1
            ;;
        *)
            if [[ $# -gt 0 ]] && [[ ! "$1" =~ ^-+ ]]; then
                params+=( "$1" ) ; shift 1
            fi
            ;;
    esac
done

if [ ${#params[@]} -lt ${NUM_POS_ARGS} ]; then
    echo "${PROGNAME}: ${NUM_POS_ARGS} positional arguments are required" >&2
    usage >&2 ; exit 1 ; 
fi

metal_info="${params[0]}"

############################################################

show_metal_input_files ${metal_info}
